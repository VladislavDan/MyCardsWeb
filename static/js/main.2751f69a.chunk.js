(this["webpackJsonpmy-cards-web"]=this["webpackJsonpmy-cards-web"]||[]).push([[0],{168:function(e,n,t){},169:function(e,n,t){},170:function(e,n,t){},180:function(e,n,t){},181:function(e,n,t){},183:function(e,n,t){},184:function(e,n,t){},185:function(e,n,t){},186:function(e,n,t){},187:function(e,n,t){},188:function(e,n,t){},189:function(e,n,t){},190:function(e,n,t){},191:function(e,n,t){},192:function(e,n,t){},194:function(e,n,t){"use strict";t.r(n);var r,a=t(1),i=t.n(a),c=t(62),o=t.n(c),s=(t(168),t(10)),u=t(13),l=t(86),d=(t(169),t(15)),h=t(16),p=t(53),b={path:"/google-auth",name:"Auth Google"},j={path:"/google-backups",name:"Google Backups"},f={path:"/cards-groups",name:"Cards Groups"},g={path:"/cards-list",name:"Cards"},O={path:"/cards-repeater",name:"Repeat Card"},C={path:"/cards-editor",name:"Edit Card"},v={path:"/local-backups",name:"Local Backups"},x={path:"/cards-group-editor",name:"Edit Group"},m={path:"/settings",name:"Settings"},S={path:"/card-viewer",name:"Card Preview"},k=new(function(){function e(){Object(h.a)(this,e)}return Object(p.a)(e,[{key:"getPageLabel",value:function(e){return e===b.path?b.name:e===j.path?j.name:e===f.path?f.name:e===g.path?g.name:e===O.path?O.name:e===v.path?v.name:e===m.path||e===S.path?m.name:"My Cards"}}]),e}()),w=t(270),D=t(272),E=t(273),I=t(91),G=t(136),y=t.n(G),T=(t(170),t(0)),B=function(e){var n=e.pageLabel,t=e.onClick;return Object(T.jsx)(w.a,{position:"fixed",children:Object(T.jsxs)(D.a,{className:"toolbar",children:[Object(T.jsx)(E.a,{className:"toolbar_menu-icon",edge:"start",color:"inherit","aria-label":"menu",onClick:t,children:Object(T.jsx)(y.a,{})}),Object(T.jsx)(I.a,{className:"toolbar_label",variant:"h6",children:n})]})})},R=t(258),N=t(264),A=function(e){var n=e.value,t=e.other;return JSON.stringify(n)===JSON.stringify(t)},F=t(21),P=function(e,n){var t=function(e){var n="(function worker() {\n            var self = this;\n            self.onmessage = function(e) {\n                const result = (".concat(e.toString(),")(e.data)\n                self.postMessage(result);\n            }\n        })()"),t=new Blob([n],{type:"text/javascript"});return new Worker(URL.createObjectURL(t))}(n);return new F.a((function(n){t.postMessage(e),t.onmessage=function(e){n.next(e.data),t.terminate(),n.complete()},t.onerror=function(e){n.error(e)}}))},L=function(){function e(n){Object(h.a)(this,e),this.outputSubject=void 0,this.observableCreator=void 0,this.subscriptions=[],this.previousEmittedValue=null,this.outputSubject=new N.a,this.observableCreator=n}return Object(p.a)(e,[{key:"next",value:function(e){var n=this;this.subscriptions.push(this.observableCreator(e).subscribe((function(e){n.outputSubject.next(e)}),(function(e){n.outputSubject.error(e)})))}},{key:"subscribe",value:function(e,n){var t=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.outputSubject.subscribe((function(n){e&&(r?t.deepEqual(e,n):e(n))}),(function(e){n&&n(e),console.error(e)}));return this.subscriptions.push(a),a}},{key:"deepEqual",value:function(e,n){this.previousEmittedValue||e(n),this.previousEmittedValue=n;var t=P({value:n,other:this.previousEmittedValue},A).subscribe((function(t){t&&e(n)}),(function(e){console.error(e)}));this.subscriptions.push(t)}},{key:"unsubscribe",value:function(){this.subscriptions.forEach((function(e){e.closed||e.unsubscribe()})),this.subscriptions=[]}}]),e}(),_=new function e(){Object(h.a)(this,e),this.navigationPanelOpenChannel=void 0,this.navigationPanelOpenChannel=new L((function(e){return Object(R.a)(e)}))},K=function(){var e=Object(d.h)(),n=Object(a.useState)(""),t=Object(u.a)(n,2),r=t[0],i=t[1];Object(a.useEffect)((function(){var n=k.getPageLabel(e.pathname);i(n)}),[e.pathname]);return Object(T.jsx)(B,{pageLabel:r,onClick:function(){_.navigationPanelOpenChannel.next("")}})},Q=t(252),U=t(274),q=t(255),z=function(e){var n=e.path,t=e.name,r=e.toggleDrawer;return Object(T.jsx)(q.a,{button:!0,children:Object(T.jsx)(l.b,{to:n,onClick:r(!1),children:t})})},M=function(e){var n=e.isOpen,t=e.toggleDrawer;return Object(T.jsx)(Q.a,{anchor:"left",open:n,onClose:t(!1),onOpen:t(!0),children:Object(T.jsxs)(U.a,{children:[Object(T.jsx)(z,{path:f.path,name:f.name,toggleDrawer:t}),Object(T.jsx)(z,{path:b.path,name:b.name,toggleDrawer:t}),Object(T.jsx)(z,{path:v.path,name:v.name,toggleDrawer:t}),Object(T.jsx)(z,{path:m.path,name:m.name,toggleDrawer:t})]})})},H=function(e,n,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Object(a.useRef)({subscription:null});if(!i.current.subscription||i.current.subscription.closed){var c=e.subscribe(n,t,r);i.current.subscription=c}Object(a.useEffect)((function(){return function(){e.unsubscribe()}}),[e])},V=function(){var e=Object(a.useState)({isOpen:!1}),n=Object(u.a)(e,2),t=n[0],r=n[1];H(_.navigationPanelOpenChannel,(function(){r(Object(s.a)(Object(s.a)({},t),{},{isOpen:!0}))}));return Object(T.jsx)(M,{isOpen:t.isOpen,toggleDrawer:function(e){return function(n){(!n||"keydown"!==n.type||"Tab"!==n.nativeEvent.key&&"Shift"!==n.nativeEvent.key)&&r(Object(s.a)(Object(s.a)({},t),{},{isOpen:e}))}}})},J=t(265),W=t(244),Y=t(266),X=t(267),Z=t(268),$=t(269),ee=function(e){var n=e.isOpen,t=e.errorMessage,r=e.handleClose;return Object(T.jsxs)(J.a,{open:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",onClose:r,children:[Object(T.jsx)(W.a,{id:"alert-dialog-title",children:"Something went wrong"}),Object(T.jsx)(Y.a,{children:Object(T.jsx)(X.a,{id:"alert-dialog-description",children:t})}),Object(T.jsx)(Z.a,{children:Object(T.jsx)($.a,{color:"primary",onClick:r,children:"Ok"})})]})},ne=function(e){var n=e.errorService,t=Object(a.useState)({isOpen:!1,errorMessage:""}),r=Object(u.a)(t,2),i=r[0],c=r[1];H(n.errorChannel,(function(e){c({isOpen:!0,errorMessage:e})}));return Object(T.jsx)(ee,{isOpen:i.isOpen,errorMessage:i.errorMessage,handleClose:function(){c({isOpen:!1,errorMessage:""})}})},te=t(275),re=function(e){return e.isShow?Object(T.jsx)(te.a,{color:"secondary"}):null},ae=function(e){var n=e.spinnerService,t=Object(a.useState)(!1),r=Object(u.a)(t,2),i=r[0],c=r[1];return H(n.spinnerCounterChannel,(function(e){c(0!==e)})),Object(T.jsx)(re,{isShow:i})},ie={height:0,width:0,updateContext:function(){}},ce="dd-MM-yyyy",oe=function(e){var n=e.onClickAgree,t=e.onClickDisagree,r=e.isOpen,a=e.message,i=e.onClose;return Object(T.jsx)("div",{children:Object(T.jsxs)(J.a,{open:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",onClose:i,children:[Object(T.jsx)(W.a,{id:"alert-dialog-title",children:"Warning"}),Object(T.jsx)(Y.a,{children:Object(T.jsx)(X.a,{id:"alert-dialog-description",children:a})}),Object(T.jsxs)(Z.a,{children:[Object(T.jsx)($.a,{onClick:t,color:"primary",children:"Disagree"}),Object(T.jsx)($.a,{onClick:n,color:"primary",autoFocus:!0,children:"Agree"})]})]})})},se=function(e){var n=e.confirmDialogService,t=a.useState({isOpen:!1,message:""}),r=Object(u.a)(t,2),i=r[0],c=r[1];H(n.openDialogChannel,(function(e){c(Object(s.a)({},e))}));return Object(T.jsx)(oe,{isOpen:i.isOpen,onClickAgree:function(){n.confirmationChannel.next(!0)},onClickDisagree:function(){n.confirmationChannel.next(!1)},onClose:function(){c({isOpen:!1,message:""}),n.confirmationChannel.unsubscribe()},message:i.message})},ue=t(137),le=t(113),de=(t(180),t(276)),he=t(106),pe=t.n(he),be=(t(181),function(e){var n=e.onClick;return Object(T.jsx)(de.a,{size:"medium",color:"secondary","aria-label":"add",className:"add-button",onClick:n,children:Object(T.jsx)(pe.a,{})})}),je=t(110),fe=t(71),ge=t(108),Oe=t(278),Ce=t(277),ve=function(e){var n=e.percent;return Object(T.jsxs)(Ce.a,{position:"relative",display:"inline-flex",children:[Object(T.jsx)(Oe.a,{variant:"determinate",value:n}),Object(T.jsx)(Ce.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(T.jsx)(I.a,{variant:"caption",component:"div",color:"textSecondary",children:"".concat(Math.round(n),"%")})})]})},xe=t(107),me=t.n(xe),Se=t(145),ke=t(262),we=function(e){var n=e.onEdit,t=e.onDelete,r=e.onResetProgress,a=i.a.useState(null),c=Object(u.a)(a,2),o=c[0],s=c[1],l=function(){s(null)};return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)(Se.a,{id:"simple-menu",anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:l,children:[Object(T.jsx)(ke.a,{onClick:function(){n(),l()},children:"Edit"}),Object(T.jsx)(ke.a,{onClick:function(){r(),l()},children:"Reset progress"}),Object(T.jsx)(ke.a,{onClick:function(){t(),l()},children:"Delete"})]}),Object(T.jsx)(E.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},children:Object(T.jsx)(me.a,{})})]})},De=(t(183),function(e){var n=e.cardsGroup,t=e.onClickItem,r=e.onEditItem,a=e.onDeleteItem,i=e.onResetProgress;return Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)(q.a,{button:!0,component:"div",children:[Object(T.jsx)(fe.a,{onClick:function(){return t(n.id)},children:Object(T.jsx)(ve,{percent:n.percentRepeatedCards||0})}),Object(T.jsx)(ge.a,{className:"cards-groups-list-item_card-name",onClick:function(){return t(n.id)},primary:n.nameCardsGroup,secondary:"Last repeating date: "+Object(je.a)(n.repeatingDate?n.repeatingDate:new Date,ce)}),Object(T.jsx)(fe.a,{children:Object(T.jsx)(we,{onEdit:function(){return r(n.id)},onDelete:function(){return a(n.id)},onResetProgress:function(){return i(n.id)}})})]},n.id)})}),Ee=function(e){var n=e.cardsGroups,t=e.onClickItem,r=e.onEditItem,a=e.onDeleteItem,i=e.onOpenEditor,c=e.onResetProgress,o=e.height,s=e.width;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(le.a,{className:"cards-groups",itemData:n,itemSize:55,itemCount:n.length,overscanCount:5,height:o,width:s,children:function(e){var i=e.index,o=e.style,s=n[i];return Object(T.jsx)("div",{style:o,children:Object(T.jsx)(De,{cardsGroup:s,onClickItem:t,onEditItem:r,onDeleteItem:a,onResetProgress:c},s.id)})}}),Object(T.jsx)(be,{onClick:i})]})},Ie=function(e){var n=Object(a.useRef)({isFirstRun:!0});n.current.isFirstRun&&(e(),n.current.isFirstRun=!1)},Ge=function(){var e=Object(a.useRef)([]);return Object(a.useEffect)((function(){return function(){e.current.forEach((function(e){e.closed||e.unsubscribe()})),e.current=[]}}),[]),{setSubscription:function(n){e.current.push(n)}}},ye=function(e){var n=e.cardsGroupsListService,t=e.confirmDialogService,r=Object(a.useState)({cardsGroups:[]}),i=Object(u.a)(r,2),c=i[0],o=i[1],s=Object(d.g)(),l=Object(a.useContext)(Xn);H(n.groupsListChannel,(function(e){o({cardsGroups:e})})),H(n.groupDeleteChannel,(function(){n.groupsListChannel.next("")})),H(n.resetProgressChannel,(function(){n.groupsListChannel.next("")})),Ie((function(){n.groupsListChannel.next("")}));var h=Ge().setSubscription;return Object(T.jsx)(Ee,{onClickItem:function(e){s.push({pathname:g.path,state:{cardsGroupID:e}})},onOpenEditor:function(){s.push({pathname:x.path})},onDeleteItem:function(e){var r=t.confirmationChannel.subscribe((function(r){r&&n.groupDeleteChannel.next(e),t.openDialogChannel.next({isOpen:!1,message:""})}));h(r),t.openDialogChannel.next({isOpen:!0,message:"Do you want to remove this group?"})},onEditItem:function(e){s.push({pathname:x.path,state:{cardsGroupID:e}})},onResetProgress:function(e){var r=t.confirmationChannel.subscribe((function(r){r&&n.resetProgressChannel.next(e),t.openDialogChannel.next({isOpen:!1,message:""})}));h(r),t.openDialogChannel.next({isOpen:!0,message:"Do you want to reset progress of this group?"})},height:l.height,width:l.width,cardsGroups:c.cardsGroups})},Te=t(139),Be=t.n(Te),Re=(t(184),function(e){var n=e.onSuccess,t=e.onFailure,r=e.height,a=e.width;return Object(T.jsx)("div",{className:"google-auth",style:{height:r,width:a},children:Object(T.jsx)(Be.a,{className:"google-auth_button",clientId:"627973926597-tj2la0mnorvm04cqmcosu2nj3b02g6k2.apps.googleusercontent.com",buttonText:"Login",onSuccess:n,onFailure:t,scope:"profile email https://www.googleapis.com/auth/drive"})})}),Ne=function(e){var n=e.googleAuthService,t=e.errorService,r=Object(d.g)();H(n.loginChannel,(function(){r.replace(j.path)}));var i=a.useContext(Xn),c=i.height,o=i.width;return Object(T.jsx)(Re,{onSuccess:function(e){n.loginChannel.next(e.accessToken)},onFailure:function(){t.errorChannel.next("Error of connection")},height:c,width:o})},Ae=function(e){var n=e.backupID,t=e.onLoad,r=e.onDelete,a=i.a.useState(null),c=Object(u.a)(a,2),o=c[0],s=c[1];return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)(Se.a,{id:"simple-menu",anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:function(){s(null)},children:[Object(T.jsx)(ke.a,{onClick:function(){s(null),t(n)},children:"Load"}),Object(T.jsx)(ke.a,{onClick:function(){s(null),r(n)},children:"Delete"})]}),Object(T.jsx)(E.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},children:Object(T.jsx)(me.a,{})})]})},Fe=function(e){var n=e.backupName,t=e.backupID,r=e.onLoad,a=e.onDelete;return Object(T.jsxs)(q.a,{children:[Object(T.jsx)(ge.a,{primary:n}),Object(T.jsx)(fe.a,{children:Object(T.jsx)(Ae,{backupID:t,onLoad:r,onDelete:a})})]})},Pe=function(e){var n=e.backupsFiles,t=e.onLoad,r=e.onCreate,a=e.onDelete;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(U.a,{children:n.map((function(e){return Object(T.jsx)(Fe,{backupName:e.createdTime,onLoad:t,onDelete:a,backupID:e.id},e.id)}))}),Object(T.jsx)(be,{onClick:r})]})},Le=function(e){var n=e.spinnerService,t=e.googleBackupsService,r=e.confirmDialogService,i=Object(d.g)(),c=Object(a.useState)({backupsFiles:[]}),o=Object(u.a)(c,2),l=o[0],h=o[1];H(t.backupsNameLoadChannel,(function(e){h(Object(s.a)(Object(s.a)({},l),{},{backupsFiles:e})),n.spinnerCounterChannel.next(-1)}),(function(){n.spinnerCounterChannel.next(-1),i.replace(b.path)})),H(t.backupLoadChannel,(function(){n.spinnerCounterChannel.next(-1)}),(function(){n.spinnerCounterChannel.next(-1),i.replace(b.path)})),H(t.backupDeleteChannel,(function(){n.spinnerCounterChannel.next(-1)})),H(t.backupUploadChannel,(function(){n.spinnerCounterChannel.next(-1)})),Ie((function(){t.backupsNameLoadChannel.next("")}));var p=Ge().setSubscription;return Object(T.jsx)(Pe,{backupsFiles:l.backupsFiles,onLoad:function(e){n.spinnerCounterChannel.next(1),t.backupLoadChannel.next(e)},onDelete:function(e){t.backupLoadChannel.next(e);var a=r.confirmationChannel.subscribe((function(a){a&&(n.spinnerCounterChannel.next(1),t.backupDeleteChannel.next(e)),r.openDialogChannel.next({isOpen:!1,message:""})}));p(a),r.openDialogChannel.next({isOpen:!0,message:"Do you want to delete this backup?"})},onCreate:function(){n.spinnerCounterChannel.next(1),t.backupUploadChannel.next()}})},_e=t(140),Ke=t.n(_e);!function(e){e[e.TO_DO=0]="TO_DO",e[e.IN_PROGRESS=1]="IN_PROGRESS",e[e.DONE=2]="DONE"}(r||(r={}));t(185);var Qe,Ue=t(256),qe=function(e){var n=e.card,t=e.onEditItem,a=e.onDeleteItem,i=e.onResetProgress,c=e.onClickItem,o=(e.onSelect,e.isEnabledSelecting),s=e.isSelected;return Object(T.jsxs)(q.a,{button:!0,children:[Object(T.jsx)(fe.a,{onClick:function(){return c(n.id)},children:Object(T.jsx)(Ke.a,{style:{color:function(e){return e.rangeOfKnowledge===r.DONE?"green":e.rangeOfKnowledge===r.IN_PROGRESS?"yellow":"red"}(n)}})}),Object(T.jsx)(ge.a,{className:"cards-list-item_card-name",onClick:function(){return o?function(){}:c(n.id)},primary:n.question,secondary:"Last repeating date: "+Object(je.a)(n.dateRepeating?n.dateRepeating:new Date,ce)}),o?Object(T.jsx)(fe.a,{children:Object(T.jsx)(Ue.a,{edge:"start",checked:s,tabIndex:-1,disableRipple:!0})}):Object(T.jsx)(fe.a,{children:Object(T.jsx)(we,{onEdit:function(){return t(n.id)},onDelete:function(){return a(n.id)},onResetProgress:function(){return i(n.id)}})})]},n.id)},ze=(t(186),t(257)),Me=t(279),He=t(250),Ve=t(282),Je=t(254),We=t(141),Ye=t.n(We);!function(e){e.NONE="\u041d\u0435\u0442 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438",e.QUESTION_ASK="\u041f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u043d\u0438\u044e",e.QUESTION_DESK="\u041f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",e.STATUS_ASK="\u041f\u043e \u0441\u0442\u0441\u0430\u0442\u0443\u0441\u0443 \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u043d\u044b\u0435",e.STATUS_DESK="\u041f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u043d\u044b\u0435"}(Qe||(Qe={}));var Xe=function(e){var n=e.onChangeSearchableText,t=e.filter,r=e.onChangeSorting;return Object(T.jsxs)(ze.a,{children:[Object(T.jsx)(Me.a,{expandIcon:Object(T.jsx)(Ye.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(T.jsx)(He.a,{className:"text-editor",required:!0,id:"outlined-required",placeholder:"Search card",onChange:function(e){n(e.target.value)},style:{marginRight:"20px"},onClick:function(e){e.stopPropagation(),e.preventDefault()}})}),Object(T.jsx)(Ve.a,{children:Object(T.jsxs)(Je.a,{value:t.sort,label:"Sorting",onChange:function(e){r(e.target.value)},children:[Object(T.jsx)(ke.a,{value:Qe.NONE,children:Qe.NONE}),Object(T.jsx)(ke.a,{value:Qe.QUESTION_ASK,children:Qe.QUESTION_ASK}),Object(T.jsx)(ke.a,{value:Qe.QUESTION_DESK,children:Qe.QUESTION_DESK}),Object(T.jsx)(ke.a,{value:Qe.STATUS_ASK,children:Qe.STATUS_ASK}),Object(T.jsx)(ke.a,{value:Qe.STATUS_DESK,children:Qe.STATUS_DESK})]})})]})},Ze=t(143),$e=t.n(Ze),en=t(142),nn=t.n(en),tn=(t(187),function(e){var n=e.onOpenEditor,t=e.onOpenRepeater,r=e.onStartSelecting;return Object(T.jsxs)("div",{className:"cards-list-actions",children:[Object(T.jsx)(de.a,{size:"medium",color:"secondary",onClick:r,children:Object(T.jsx)(nn.a,{})}),Object(T.jsx)(de.a,{size:"medium",color:"primary",onClick:t,children:Object(T.jsx)($e.a,{})}),Object(T.jsx)(de.a,{size:"medium",color:"secondary",onClick:n,children:Object(T.jsx)(pe.a,{})})]})}),rn=function(e){var n=e.cards,t=e.filter,r=e.onOpenEditor,a=e.onEditItem,i=e.onDeleteItem,c=e.onResetProgress,o=e.onClickItem,s=e.onChangeSearchableText,u=e.onChangeSorting,l=e.width,d=e.onOpenRepeater,h=e.onStartSelecting,p=e.isEnabledSelecting;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(Xe,{onChangeSearchableText:s,onChangeSorting:u,filter:t}),Object(T.jsx)(le.a,{className:"cards",itemData:n,itemSize:55,itemCount:n.length,overscanCount:5,height:55*n.length,width:l,children:function(e){var t=e.index,r=e.style,s=n[t];return Object(T.jsx)("div",{style:r,children:Object(T.jsx)(qe,{card:s,onEditItem:a,onDeleteItem:i,onResetProgress:c,onClickItem:o,onSelect:function(){},isEnabledSelecting:p,isSelected:!1},s.id)})}}),Object(T.jsx)(tn,{onOpenRepeater:d,onOpenEditor:r,onStartSelecting:h})]})},an=function(e){var n=e.cardsListService,t=e.confirmDialogService,r=Object(d.h)(),i=Object(d.g)(),c=Object(a.useState)({cards:[],filter:{searchableText:"",sort:Qe.NONE},isEnabledSelecting:!1}),o=Object(u.a)(c,2),l=o[0],h=o[1],p=Object(a.useContext)(Xn);H(n.cardsChannel,(function(e){h((function(n){return Object(s.a)(Object(s.a)({},n),{},{cards:e})}))})),H(n.resetCardProgressChannel,(function(e){n.cardsChannel.next({cardsGroupID:r.state.cardsGroupID,filter:l.filter})})),H(n.deleteCardChannel,(function(e){n.cardsChannel.next({cardsGroupID:r.state.cardsGroupID,filter:l.filter})})),Ie((function(){n.cardsChannel.next({cardsGroupID:r.state.cardsGroupID,filter:l.filter})}));var b=Ge().setSubscription;return Object(T.jsx)(rn,{filter:l.filter,onChangeSorting:function(e){var t=Object(s.a)(Object(s.a)({},l.filter),{},{sort:e});h(Object(s.a)(Object(s.a)({},l),{},{filter:t})),n.cardsChannel.next({cardsGroupID:r.state.cardsGroupID,filter:t})},onChangeSearchableText:function(e){var t=Object(s.a)(Object(s.a)({},l.filter),{},{searchableText:e});h(Object(s.a)(Object(s.a)({},l),{},{filter:t})),n.cardsChannel.next({cardsGroupID:r.state.cardsGroupID,filter:t})},cards:l.cards,onOpenEditor:function(){i.push({pathname:C.path,state:{cardsGroupID:r.state.cardsGroupID}})},onEditItem:function(e){i.push({pathname:C.path,state:{cardsGroupID:r.state.cardsGroupID,cardID:e}})},onDeleteItem:function(e){var a=t.confirmationChannel.subscribe((function(a){a&&n.deleteCardChannel.next({cardID:e,cardsGroupID:r.state.cardsGroupID}),t.openDialogChannel.next({isOpen:!1,message:""})}));b(a),t.openDialogChannel.next({isOpen:!0,message:"Do you want to remove this card?"})},onResetProgress:function(e){n.resetCardProgressChannel.next({cardID:e,cardsGroupID:r.state.cardsGroupID})},onClickItem:function(e){i.push({pathname:S.path,state:{cardsGroupID:r.state.cardsGroupID,cardID:e}})},width:p.width,height:p.height,onOpenRepeater:function(){i.push({pathname:O.path,state:r.state})},onStartSelecting:function(){h(Object(s.a)(Object(s.a)({},l),{},{isEnabledSelecting:!l.isEnabledSelecting}))},isEnabledSelecting:l.isEnabledSelecting})},cn=function(e){var n=e.statistic;return Object(T.jsxs)("div",{children:[Object(T.jsx)($.a,{size:"small",children:Object(T.jsxs)("span",{style:{color:"red"},children:["To Do: ",n.todo]})}),Object(T.jsx)($.a,{size:"small",children:Object(T.jsxs)("span",{style:{color:"orange"},children:["In progress: ",n.inProgress]})}),Object(T.jsx)($.a,{size:"small",children:Object(T.jsxs)("span",{style:{color:"green"},children:["Completed: ",n.done]})})]})},on=t(285),sn=t(284),un=t(283),ln=function(e){var n=e.card,t=e.onClick;return Object(T.jsx)(T.Fragment,{children:n&&n.rangeOfKnowledge!==r.DONE?Object(T.jsxs)(un.a,{className:"cards-repeater_buttons-container",style:{height:10},children:[Object(T.jsx)($.a,{size:"small",color:"primary",onClick:function(){return t(!0)},children:"Yes"}),Object(T.jsx)($.a,{size:"small",color:"primary",onClick:function(){return t(!1)},children:"No"})]}):Object(T.jsx)("div",{children:"Repeated"})})},dn=(t(188),function(e){var n=e.onChangeText,t=e.changeableText,r=e.label;return Object(T.jsx)(He.a,{className:"text-editor",required:!0,id:"outlined-required",label:r||"",multiline:!0,onChange:function(e){n(e.target.value)},value:t,variant:"filled"})}),hn=function(e){var n=e.card,t=e.cardHeight,r=e.onClickText,a=e.onClick,i=e.isEditable,c=e.onChangeAnswer,o=function(){return n?n.answer:""};return Object(T.jsx)(sn.a,{className:"cards-repeater",children:Object(T.jsx)(on.a,{style:{height:t},children:i?Object(T.jsx)("div",{style:{paddingTop:0,height:t,overflow:"auto",whiteSpace:"pre-wrap"},children:Object(T.jsx)(U.a,{style:{paddingTop:0},children:Object(T.jsx)(dn,{onChangeText:c,changeableText:o()})})}):Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(I.a,{color:"textSecondary",gutterBottom:!0,onClick:r,style:{paddingTop:0,height:t,overflow:"auto",whiteSpace:"pre-wrap"},children:Object(T.jsx)(U.a,{style:{paddingTop:0},children:o()})}),Object(T.jsx)(ln,{onClick:a,card:n})]})})})},pn=(t(189),t(246)),bn=t(247),jn=function(e){var n=e.isQuestionSide,t=e.onSwitchEditing,r=e.isEditable;return Object(T.jsxs)("div",{className:"cards-repeater_title",children:[Object(T.jsx)(I.a,{gutterBottom:!0,variant:"h5",component:"h2",children:n?"Question":"Answer"}),Object(T.jsx)(E.a,{color:"inherit",onClick:t,children:r?Object(T.jsx)(pn.a,{}):Object(T.jsx)(bn.a,{})})]})},fn=function(e){var n=e.onBackClick;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("span",{children:"All cards repeated"}),Object(T.jsx)($.a,{size:"small",color:"primary",onClick:n,children:"Go back"})]})},gn=function(e){var n=e.card,t=e.onClickCard,r=e.cardHeight,a=e.isEditable,i=e.onChangeQuestion,c=n?n.question:"";return Object(T.jsx)(sn.a,{children:Object(T.jsx)(on.a,{onClick:t,style:{height:r},children:a?Object(T.jsx)("div",{style:{paddingTop:0,height:r,overflow:"auto",whiteSpace:"pre-wrap"},children:Object(T.jsx)(U.a,{style:{paddingTop:0},children:Object(T.jsx)(dn,{onChangeText:i,changeableText:c})})}):Object(T.jsx)(I.a,{color:"textSecondary",gutterBottom:!0,children:c})})})},On=function(e){var n=e.card,t=e.cardHeight,r=e.isQuestionSide,a=e.onClickCard,i=e.onClick,c=e.statistic,o=e.onBackClick,s=e.onSwitchEditing,u=e.isEditable,l=e.onChangeAnswer,d=e.onChangeQuestion;return n?Object(T.jsxs)("div",{className:"cards-repeater",children:[Object(T.jsx)(cn,{statistic:c}),Object(T.jsx)(jn,{isQuestionSide:r,isEditable:u,onSwitchEditing:s}),r?Object(T.jsx)(gn,{card:n,onClickCard:a,cardHeight:t,isEditable:u,onChangeQuestion:d}):Object(T.jsx)(hn,{card:n,onClickText:a,cardHeight:t,onClick:i,onChangeAnswer:l,isEditable:u})]}):Object(T.jsx)(fn,{onBackClick:o})},Cn=function(){return{rangeOfKnowledge:r.IN_PROGRESS,answer:"",question:"",dateRepeating:0,id:(new Date).getTime()}},vn=function(e){var n=e.cardsRepeaterService,t=e.cardsEditorService,r=Object(d.h)(),i=Object(d.g)(),c=Object(a.useState)({card:void 0,isQuestionSide:!0,isEditable:!1}),o=Object(u.a)(c,2),l=o[0],h=o[1],p=Object(a.useState)({inProgress:0,todo:0,done:0}),b=Object(u.a)(p,2),j=b[0],g=b[1];H(n.cardChannel,(function(e){h({card:e,isQuestionSide:!0,isEditable:!1}),n.statisticChannel.next("")})),H(t.cardEditingChannel,(function(e){h((function(n){return Object(s.a)(Object(s.a)({},n),{},{card:e})}))})),H(n.currentCardChannel,(function(e){e?h({card:e,isQuestionSide:!0,isEditable:!1}):n.cardChannel.next(r.state?r.state.cardsGroupID:-1)})),H(n.statisticChannel,(function(e){g((function(){return e}))})),H(n.repeatingResultChannel,(function(){n.cardChannel.next(r.state.cardsGroupID)})),Ie((function(){r.state?n.currentCardChannel.next(r.state.cardsGroupID):n.currentCardChannel.next(null),n.statisticChannel.next("")}));var O=Object(a.useContext)(Xn);return Object(T.jsx)(On,{cardHeight:.55*O.height,isQuestionSide:l.isQuestionSide,onClickCard:function(){l.isEditable||h(Object(s.a)(Object(s.a)({},l),{},{isQuestionSide:!l.isQuestionSide}))},onClick:function(e){l.card?n.repeatingResultChannel.next({isKnown:e,cardID:l.card.id,cardsGroupID:r.state.cardsGroupID}):h({card:void 0,isQuestionSide:!1,isEditable:!1})},card:l.card,statistic:j,onBackClick:function(){i.replace(f.path)},onSwitchEditing:function(){h(Object(s.a)(Object(s.a)({},l),{},{isEditable:!l.isEditable})),l.isEditable&&t.cardEditingChannel.next({card:l.card||Cn(),cardsGroupID:r.state.cardsGroupID})},isEditable:l.isEditable,onChangeQuestion:function(e){if(l.card){var n=Object(s.a)(Object(s.a)({},l.card),{},{question:e});h(Object(s.a)(Object(s.a)({},l),{},{card:n}))}},onChangeAnswer:function(e){if(l.card){var n=Object(s.a)(Object(s.a)({},l.card),{},{answer:e});h(Object(s.a)(Object(s.a)({},l),{},{card:n}))}}})},xn=function(e){var n=e.localBackupsService,t=e.confirmDialogService,r=e.spinnerService,i=Object(a.useRef)(null);H(n.localBackupChannel),H(n.loadBackupChannel,(function(){r.spinnerCounterChannel.next(-1)}));var c=Ge().setSubscription;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("input",{type:"file",onChange:function(e){var a=e.target.files[0];if(a){var i=new FileReader;i.onload=function(e){var a=e.target.result,i=t.confirmationChannel.subscribe((function(e){e&&(r.spinnerCounterChannel.next(1),n.loadBackupChannel.next(a)),t.openDialogChannel.next({isOpen:!1,message:""})}));c(i),t.openDialogChannel.next({isOpen:!0,message:"Do you want to load this backup, your current changes could be removed?"})},i.readAsText(a)}}}),Object(T.jsx)("a",{ref:i}),Object(T.jsx)($.a,{size:"small",onClick:function(){return n.localBackupChannel.next()},children:"Save"})]})},mn=(t(190),function(e){var n=e.groupName,t=e.onChangeGroupName,r=e.onSaveGroup;return Object(T.jsxs)("div",{className:"group-editor",children:[Object(T.jsx)(He.a,{className:"group-editor_text",required:!0,id:"outlined-required",label:"Group name",onChange:function(e){t(e.target.value)},value:n,variant:"filled"}),Object(T.jsx)($.a,{variant:"outlined",className:"group-editor_button",size:"small",onClick:function(){return r()},children:"Save"})]})}),Sn=function(e){var n=e.cardsGroupsEditorService,t=Object(d.h)(),r=Object(d.g)(),i=Object(a.useState)({cardsGroup:{cards:[],nameCardsGroup:"",repeatingDate:(new Date).getTime(),id:(new Date).getTime(),percentRepeatedCards:0}}),c=Object(u.a)(i,2),o=c[0],l=c[1];H(n.groupEditingChannel,(function(){r.goBack()})),H(n.groupChannel,(function(e){l({cardsGroup:e})})),Ie((function(){var e=t.state?t.state.cardsGroupID:-1;n.groupChannel.next(e)}));return Object(T.jsx)(mn,{groupName:o.cardsGroup.nameCardsGroup,onChangeGroupName:function(e){l({cardsGroup:Object(s.a)(Object(s.a)({},o.cardsGroup),{},{nameCardsGroup:e})})},onSaveGroup:function(){n.groupEditingChannel.next(o.cardsGroup)}})},kn=(t(191),function(e){var n=e.answer,t=e.question,r=e.onChangeAnswer,a=e.onChangeQuestion,i=e.onSaveCard,c=e.cardsGroups,o=e.currentCardsGroup,s=e.onChangeCardsGroup;return Object(T.jsxs)("div",{className:"cards-editor",children:[Object(T.jsx)(dn,{onChangeText:a,changeableText:t,label:"Question"}),Object(T.jsx)(dn,{onChangeText:r,changeableText:n,label:"Answer"}),Object(T.jsx)(Je.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",className:"cards-editor_text",value:o.id.toString(),label:o.nameCardsGroup,onChange:function(e){s(Number(e.target.value))},autoWidth:!0,children:c.map((function(e){return Object(T.jsx)(ke.a,{value:e.id.toString(),children:e.nameCardsGroup},e.id)}))}),Object(T.jsx)($.a,{variant:"outlined",className:"group-editor_button",size:"small",onClick:function(){return i()},children:"Save"})]})}),wn=function(e){var n=e.cardsEditorService,t=Object(d.h)(),r=Object(d.g)(),i=Object(a.useState)({card:Cn(),currentCardsGroup:{id:0,nameCardsGroup:""},cardsGroups:[]}),c=Object(u.a)(i,2),o=c[0],l=c[1];H(n.cardEditingChannel,(function(){r.goBack()})),H(n.simplifiedCardsGroupsChannel,(function(e){var n=e.currentCardsGroup,t=e.cardsGroups;l(n?function(e){return Object(s.a)(Object(s.a)({},e),{},{cardsGroups:t,currentCardsGroup:n})}:function(e){return Object(s.a)(Object(s.a)({},e),{},{currentCardsGroup:o.currentCardsGroup,cardsGroups:t})})})),H(n.cardChannel,(function(e){e&&l(Object(s.a)(Object(s.a)({},o),{},{card:e}))})),Ie((function(){var e=t.state?t.state.cardsGroupID:-1,r=t.state?t.state.cardID:-1;n.cardChannel.next({cardID:r,cardsGroupID:e}),n.simplifiedCardsGroupsChannel.next(e)}));return Object(T.jsx)(kn,{question:o.card.question,answer:o.card.answer,onChangeQuestion:function(e){l({card:Object(s.a)(Object(s.a)({},o.card),{},{question:e}),currentCardsGroup:o.currentCardsGroup,cardsGroups:o.cardsGroups})},onChangeAnswer:function(e){l({card:Object(s.a)(Object(s.a)({},o.card),{},{answer:e}),currentCardsGroup:o.currentCardsGroup,cardsGroups:o.cardsGroups})},onSaveCard:function(){n.cardEditingChannel.next({card:o.card,cardsGroupID:o.currentCardsGroup.id})},currentCardsGroup:o.currentCardsGroup,cardsGroups:o.cardsGroups,onChangeCardsGroup:function(e){n.simplifiedCardsGroupsChannel.next(e)}})},Dn=(t(192),t(286)),En=t(287),In=t(288),Gn=function(e){var n=e.settings,t=e.onChange;return Object(T.jsx)(Dn.a,{className:"settings-form",children:Object(T.jsx)(En.a,{control:Object(T.jsx)(In.a,{checked:n.isRandomRepeating,onChange:function(e){t(Object(s.a)(Object(s.a)({},n),{},{isRandomRepeating:e.target.checked}))}}),label:"Random repeating algorithm"})})},yn=function(e){var n=e.settingsService,t=Object(a.useState)({isRandomRepeating:!1}),r=Object(u.a)(t,2),i=r[0],c=r[1];H(n.changeSettingsChannel,(function(){n.settingsChannel.next("")})),H(n.settingsChannel,(function(e){c((function(n){return Object(s.a)(Object(s.a)({},n),e)}))})),Ie((function(){n.settingsChannel.next("")}));return Object(T.jsx)(Gn,{settings:i,onChange:function(e){n.changeSettingsChannel.next(e)}})},Tn=function(e){var n=e.card,t=e.cardHeight,r=e.isQuestionSide,a=e.onClickCard,i=e.onClick,c=e.onSwitchEditing,o=e.isEditable,s=e.onChangeAnswer,u=e.onChangeQuestion;return Object(T.jsxs)("div",{className:"cards-repeater",children:[Object(T.jsx)(jn,{isQuestionSide:r,isEditable:o,onSwitchEditing:c}),r?Object(T.jsx)(gn,{card:n,onClickCard:a,cardHeight:t,isEditable:o,onChangeQuestion:u}):Object(T.jsx)(hn,{card:n,onClickText:a,cardHeight:t,onClick:i,onChangeAnswer:s,isEditable:o})]})},Bn=function(e){var n=e.cardViewerService,t=e.cardsEditorService,r=Object(d.h)(),i=Object(d.g)(),c=Object(a.useState)({card:void 0,isQuestionSide:!0,isEditable:!1}),o=Object(u.a)(c,2),l=o[0],h=o[1];H(n.cardChannel,(function(e){h((function(n){return Object(s.a)(Object(s.a)({},n),{},{card:e})}))})),H(t.cardEditingChannel,(function(e){h((function(n){return Object(s.a)(Object(s.a)({},n),{},{card:e})}))})),H(n.repeatingResultChannel,(function(){n.cardChannel.next(r.state.cardID)})),Ie((function(){n.cardChannel.next(r.state.cardID)}));var p=Object(a.useContext)(Xn);return Object(T.jsx)(Tn,{cardHeight:.55*p.height,isQuestionSide:l.isQuestionSide,onClickCard:function(){l.isEditable||h(Object(s.a)(Object(s.a)({},l),{},{isQuestionSide:!l.isQuestionSide}))},onClick:function(e){l.card?n.repeatingResultChannel.next({isKnown:e,cardID:l.card.id,cardsGroupID:r.state.cardsGroupID}):h({card:void 0,isQuestionSide:!1,isEditable:!1})},card:l.card,onBackClick:function(){i.replace(f.path)},onSwitchEditing:function(){h(Object(s.a)(Object(s.a)({},l),{},{isEditable:!l.isEditable})),l.isEditable&&t.cardEditingChannel.next({card:l.card||Cn(),cardsGroupID:r.state.cardsGroupID})},isEditable:l.isEditable,onChangeQuestion:function(e){if(l.card){var n=Object(s.a)(Object(s.a)({},l.card),{},{question:e});h(Object(s.a)(Object(s.a)({},l),{},{card:n}))}},onChangeAnswer:function(e){if(l.card){var n=Object(s.a)(Object(s.a)({},l.card),{},{answer:e});h(Object(s.a)(Object(s.a)({},l),{},{card:n}))}}})},Rn=function(e){var n=e.cardsGroupsListService,t=e.cardsGroupsEditorService,r=e.errorService,a=e.googleAuthService,i=e.googleBackupsService,c=e.spinnerService,o=e.confirmDialogService,s=e.cardsEditorService,u=e.cardsListService,l=e.cardsRepeaterService,h=e.settingsService,p=e.localBackupsService,k=e.cardViewerService;return Object(T.jsxs)(d.d,{children:[Object(T.jsx)(d.a,{exact:!0,from:"/MyCardsWeb",to:f.path}),Object(T.jsx)(d.a,{exact:!0,from:"/",to:f.path}),Object(T.jsx)(d.b,{path:f.path,children:Object(T.jsx)(ye,{cardsGroupsListService:n,confirmDialogService:o})}),Object(T.jsx)(d.b,{path:b.path,children:Object(T.jsx)(Ne,{googleAuthService:a,errorService:r})}),Object(T.jsx)(d.b,{path:j.path,children:Object(T.jsx)(Le,{googleBackupsService:i,spinnerService:c,confirmDialogService:o})}),Object(T.jsx)(d.b,{path:g.path,children:Object(T.jsx)(an,{cardsListService:u,confirmDialogService:o})}),Object(T.jsx)(d.b,{path:O.path,children:Object(T.jsx)(vn,{cardsRepeaterService:l,cardsEditorService:s})}),Object(T.jsx)(d.b,{path:v.path,children:Object(T.jsx)(xn,{localBackupsService:p,confirmDialogService:o,spinnerService:c})}),Object(T.jsx)(d.b,{path:x.path,children:Object(T.jsx)(Sn,{cardsGroupsEditorService:t})}),Object(T.jsx)(d.b,{path:C.path,children:Object(T.jsx)(wn,{cardsEditorService:s})}),Object(T.jsx)(d.b,{path:m.path,children:Object(T.jsx)(yn,{settingsService:h})}),Object(T.jsx)(d.b,{path:S.path,children:Object(T.jsx)(Bn,{cardViewerService:k,cardsEditorService:s})})]})},Nn=t(248),An=t(249),Fn=t(259),Pn=function(){function e(n){var t=this;Object(h.a)(this,e),this.storageService=n,this.backupsNameLoadChannel=void 0,this.backupLoadChannel=void 0,this.backupUploadChannel=void 0,this.backupDeleteChannel=void 0,this.backupFileName="my-cards.json",this.backupFolderName="my-cards",this.googleDriveFilesAPI="https://www.googleapis.com/drive/v3/files/",this.googleDriveUploadAPI="https://www.googleapis.com/upload/drive/v3/files/",this.searchFilesURI=this.googleDriveFilesAPI+"?fields=files(id,createdTime)&q=name%20contains%20",this.searchFolderURI=this.googleDriveFilesAPI+"?q=name%20contains%20",this.getFilesAdditionalPartURI="?alt=media",this.googleDriveFolderType="application/vnd.google-apps.folder",this.backupsNameLoadChannel=new L((function(){return Object(R.a)("").pipe(Object(An.a)((function(){return n.getAuthToken()})),Object(An.a)((function(e){return t.getBackupFiles(e)})),Object(ue.a)((function(e){return function(e){return e.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{createdTime:e.createdTime.slice(0,10)})}))}(e)})))})),this.backupLoadChannel=new L((function(e){return Object(R.a)("").pipe(Object(An.a)((function(){return t.loadBackupFile(e)})))})),this.backupUploadChannel=new L((function(){return Object(R.a)("").pipe(Object(An.a)((function(){return n.getAuthToken()})),Object(An.a)((function(e){return t.createNewBackup(e)})))})),this.backupDeleteChannel=new L((function(e){return Object(R.a)("").pipe(Object(An.a)((function(){return t.deleteBackupFile(e)})),Object(Nn.a)((function(){t.backupsNameLoadChannel.next("")})))}))}return Object(p.a)(e,[{key:"createNewBackup",value:function(e){var n=this;return this.getBackupFolder(e).pipe(Object(An.a)((function(t){if(t){var r=t.find((function(e){return e.mimeType===n.googleDriveFolderType}));return r?Object(R.a)(r.id):n.createBackupFolder(e)}return n.createBackupFolder(e)})),Object(An.a)((function(t){return n.createNewBackupFile(e,t)})),Object(An.a)((function(t){return n.uploadBackupFile(e,t)})),Object(Nn.a)((function(){n.backupsNameLoadChannel.next("")})))}},{key:"getBackupFiles",value:function(e){return Object(Fn.a)({url:"".concat(this.searchFilesURI,"'").concat(this.backupFileName,"'"),headers:{Authorization:"Bearer "+e},method:"GET"}).pipe(Object(ue.a)((function(e){return e.response.files})))}},{key:"loadBackupFile",value:function(e){var n=this;return this.storageService.getAuthToken().pipe(Object(An.a)((function(t){return Object(Fn.a)({url:n.googleDriveFilesAPI+e+n.getFilesAdditionalPartURI,headers:{Authorization:"Bearer "+t},method:"GET"})})),Object(ue.a)((function(e){return n.storageService.setBackup(e.response),e.response})))}},{key:"getBackupFolder",value:function(e){return Object(Fn.a)({url:"".concat(this.searchFolderURI,"'").concat(this.backupFolderName,"'"),headers:{Authorization:"Bearer "+e},method:"GET"}).pipe(Object(ue.a)((function(e){return e.response.files})))}},{key:"deleteBackupFile",value:function(e){var n=this;return this.storageService.getAuthToken().pipe(Object(An.a)((function(t){return Object(Fn.a)({url:n.googleDriveFilesAPI+e,headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},method:"DELETE"})})))}},{key:"createNewBackupFile",value:function(e,n){return Object(Fn.a)({url:this.googleDriveFilesAPI,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:{parents:[n],name:this.backupFileName},method:"POST"}).pipe(Object(ue.a)((function(e){return e.response.id})))}},{key:"createBackupFolder",value:function(e){return Object(Fn.a)({url:this.googleDriveFilesAPI,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:{name:this.backupFolderName,mimeType:"application/vnd.google-apps.folder"},method:"POST"}).pipe(Object(ue.a)((function(e){return e.response.id})))}},{key:"uploadBackupFile",value:function(e,n){var t=this;return this.storageService.getBackup().pipe(Object(An.a)((function(r){return Object(Fn.a)({url:t.googleDriveUploadAPI+n,headers:{Authorization:"Bearer "+e},body:JSON.stringify(r,null,4),responseType:"text",method:"PATCH"}).pipe(Object(ue.a)((function(){return n})))})))}}]),e}(),Ln=t(42),_n=t.n(Ln),Kn=t(64),Qn=t(111),Un=function(){function e(n){var t=this;Object(h.a)(this,e),this.dataBaseService=n,this.cardsStorageID="cards-local-storage",this.authTokenLocalStorageID="auth-token",this.settingsID="settings",this.getBackup=function(){return Object(Qn.a)(t.getBackupFromDataBase())},this.getBackupFromDataBase=Object(Kn.a)(_n.a.mark((function e(){var n;return _n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,t.dataBaseService.get(t.cardsStorageID);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",n);case 11:if(!n){e.next=15;break}return e.abrupt("return",n);case 15:return e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[1,7]])}))),this.setBackupToDataBase=function(){var e=Object(Kn.a)(_n.a.mark((function e(n){return _n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.dataBaseService.set(t.cardsStorageID,n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(n){return e.apply(this,arguments)}}()}return Object(p.a)(e,[{key:"setBackup",value:function(e){return Object(Qn.a)(this.setBackupToDataBase(e))}},{key:"getAuthToken",value:function(){var e=this;return Object(Qn.a)(new Promise((function(n,t){var r=localStorage.getItem(e.authTokenLocalStorageID);r?n(r):t("Auth token is empty")})))}},{key:"setAuthToken",value:function(e){var n=this;return Object(Qn.a)(new Promise((function(t){localStorage.setItem(n.authTokenLocalStorageID,e),t(e)})))}},{key:"getSettings",value:function(){var e=this;return Object(Qn.a)(new Promise((function(n,t){var r=localStorage.getItem(e.settingsID);n(r?JSON.parse(r):{isRandomRepeating:!1})})))}},{key:"setSettings",value:function(e){var n=this;return Object(Qn.a)(new Promise((function(t){localStorage.setItem(n.settingsID,JSON.stringify(e)),t(e)})))}}]),e}(),qn=function(e,n){var t=e.find((function(e){return!n||e.id===n})),r=[];return t&&(r=t.cards),r},zn=function(e,n){return n.forEach((function(n){e.cardsGroupID&&n.id!==e.cardsGroupID||n.cards.forEach((function(n){e.cardID&&n.id!==e.cardID||(e.isKnown&&n.rangeOfKnowledge===r.IN_PROGRESS||e.isKnown&&n.rangeOfKnowledge===r.TO_DO?n.rangeOfKnowledge=r.DONE:e.isKnown||n.rangeOfKnowledge!==r.TO_DO||(n.rangeOfKnowledge=r.IN_PROGRESS))}))})),n},Mn=function(e,n){var t;n?t=e.filter((function(e){return e.rangeOfKnowledge!==r.DONE}))[0]:((t=e.find((function(e){return e.rangeOfKnowledge===r.TO_DO})))||(t=e.find((function(e){return e.rangeOfKnowledge===r.IN_PROGRESS}))),1===e.length&&(t=e[0]));return t},Hn=function(e){var n={inProgress:0,todo:0,done:0};return e.forEach((function(e){e.rangeOfKnowledge===r.IN_PROGRESS?n.inProgress=n.inProgress+1:e.rangeOfKnowledge===r.TO_DO?n.todo=n.todo+1:n.done=n.done+1})),n},Vn=function(e){for(var n,t=[],r=e.length;r;)(n=Math.floor(Math.random()*e.length))in e&&(t.push(e[n]),delete e[n],r--);return t},Jn=function(e){return 1===e.length?e[0]:null},Wn=t(146),Yn=function(e,n){for(var t,r=0;r<e.length;r++){var a=e[r].cards.findIndex((function(e){return e.id===n}));if(a>-1)return t=e[r].cards[a]}return t},Xn=i.a.createContext(ie),Zn=new function e(){Object(h.a)(this,e),this.errorChannel=void 0,this.errorChannel=new L((function(e){return Object(R.a)(e)}))},$n=new function e(){var n=this;Object(h.a)(this,e),this.spinnerCounterChannel=void 0,this.spinnerCounter=0,this.spinnerCounterChannel=new L((function(e){return Object(R.a)("").pipe(Object(ue.a)((function(){return n.spinnerCounter+e>=0&&(n.spinnerCounter=n.spinnerCounter+e),n.spinnerCounter})))}))},et=new function e(){var n=this;Object(h.a)(this,e),this.openDialogChannel=new L((function(e){return Object(R.a)(e).pipe(Object(Nn.a)((function(e){e.isOpen||n.confirmationChannel.unsubscribe()})))})),this.confirmationChannel=new L((function(e){return Object(R.a)(e)}))},nt=new Un(new function e(n){var t=this;Object(h.a)(this,e),this.storeName=n,this.dataBase=void 0,this.DATA_BASE_NAME="my-cards-data-base",this.get=function(){var e=Object(Kn.a)(_n.a.mark((function e(n){return _n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dataBase;case 2:return e.abrupt("return",e.sent.get(t.storeName,n));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.set=function(){var e=Object(Kn.a)(_n.a.mark((function e(n,r){return _n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dataBase;case 2:return e.abrupt("return",e.sent.put(t.storeName,r,n));case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),this.dataBase=Object(Wn.a)(this.DATA_BASE_NAME,1,{upgrade:function(e){e.createObjectStore(n)}})}("cards-store")),tt=new function e(n){Object(h.a)(this,e),this.groupEditingChannel=void 0,this.groupChannel=void 0,this.groupEditingChannel=new L((function(e){return n.getBackup().pipe(Object(ue.a)((function(n){return function(e,n){var t=n.findIndex((function(n){return e.id===n.id}));return t<0?n.push(e):n[t]=e,n}(e,n)})),Object(Nn.a)((function(e){n.setBackup(e)})))})),this.groupChannel=new L((function(e){return n.getBackup().pipe(Object(ue.a)((function(n){return function(e,n){var t=n.find((function(n){return e===n.id}));return t||(t={cards:[],nameCardsGroup:"",repeatingDate:(new Date).getTime(),id:(new Date).getTime(),percentRepeatedCards:0}),t}(e,n)})))}))}(nt),rt=new function e(n){Object(h.a)(this,e),this.groupsListChannel=void 0,this.groupDeleteChannel=void 0,this.resetProgressChannel=void 0,this.groupsListChannel=new L((function(){return n.getBackup().pipe(Object(ue.a)((function(e){return function(e){return e.map((function(e){var n=0;return e.cards.forEach((function(e){e.dateRepeating>n&&(n=e.dateRepeating)})),e.repeatingDate=n,e})),e}(e)})),Object(ue.a)((function(e){return function(e){return e.sort((function(e,n){return e.repeatingDate&&n.repeatingDate?n.repeatingDate-e.repeatingDate:0}))}(e)})),Object(ue.a)((function(e){return function(e){return e.map((function(e){var n=0;return e.cards.forEach((function(e){e.rangeOfKnowledge===r.DONE&&n++})),e.percentRepeatedCards=n/e.cards.length*100,e})),e}(e)})))})),this.groupDeleteChannel=new L((function(e){return n.getBackup().pipe(Object(ue.a)((function(n){return function(e,n){return n.filter((function(n){return n.id!==e}))}(e,n)})),Object(Nn.a)((function(e){return n.setBackup(e)})))})),this.resetProgressChannel=new L((function(e){return n.getBackup().pipe(Object(ue.a)((function(n){return function(e,n){var t=n.findIndex((function(n){return e===n.id}));return t<0||(n[t].cards=n[t].cards.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{rangeOfKnowledge:r.TO_DO})}))),n}(e,n)})),Object(Nn.a)((function(e){return n.setBackup(e)})))}))}(nt),at=new function e(n){Object(h.a)(this,e),this.loginChannel=void 0,this.loginChannel=new L((function(e){return Object(R.a)("").pipe(Object(Nn.a)((function(){n.setAuthToken(e)})))}))}(nt),it=new Pn(nt),ct=new function e(n){Object(h.a)(this,e),this.cardEditingChannel=void 0,this.simplifiedCardsGroupsChannel=void 0,this.cardChannel=void 0,this.cardEditingChannel=new L((function(e){var t=e.card,r=e.cardsGroupID;return n.getBackup().pipe(Object(ue.a)((function(e){return function(e,n,t){var r=t.findIndex((function(n){return e===n.id})),a=-1;return r>=0&&(a=t[r].cards.findIndex((function(e){return n.id===e.id}))),r>=0&&a<0?t[r].cards.push(n):r>=0&&a>=0&&(t[r].cards[a]=n),t}(r,t,e)})),Object(Nn.a)((function(e){n.setBackup(e)})),Object(ue.a)((function(){return t})))})),this.cardChannel=new L((function(e){var t=e.cardID,a=e.cardsGroupID;return n.getBackup().pipe(Object(ue.a)((function(e){return function(e,n,t){var a=t.find((function(n){return e===n.id})),i={rangeOfKnowledge:r.TO_DO,answer:"",question:"",dateRepeating:0,id:(new Date).getTime()};return a&&(i=a.cards.find((function(e){return e.id===n}))),i}(a,t,e)})))})),this.simplifiedCardsGroupsChannel=new L((function(e){return n.getBackup().pipe(Object(ue.a)((function(e){return function(e){return e.map((function(e){return{id:e.id,nameCardsGroup:e.nameCardsGroup}}))}(e)})),Object(ue.a)((function(n){return function(e,n){return{currentCardsGroup:n.find((function(n){return e===n.id})),cardsGroups:n}}(e,n)})))}))}(nt),ot=new function e(n){var t=this;Object(h.a)(this,e),this.storageService=n,this.cardsChannel=void 0,this.resetCardProgressChannel=void 0,this.deleteCardChannel=void 0,this.cardsChannel=new L((function(e){var n=e.cardsGroupID,r=e.filter;return t.storageService.getBackup().pipe(Object(ue.a)((function(e){return function(e,n){var t=n.find((function(n){return n.id===e}));return t?t.cards:[]}(n,e)})),Object(ue.a)((function(e){return function(e,n){var t=e.filter((function(e){return e.question.toLowerCase().indexOf(n.searchableText.toLowerCase())>-1||e.answer.toLowerCase().indexOf(n.searchableText.toLowerCase())>-1}));return n.sort===Qe.QUESTION_DESK?t.sort((function(e,n){return e.question===n.question?0:e.question>n.question?1:-1})):n.sort===Qe.QUESTION_ASK?t.sort((function(e,n){return e.question===n.question?0:e.question>n.question?-1:1})):n.sort===Qe.STATUS_ASK?t.sort((function(e,n){return e.rangeOfKnowledge===n.rangeOfKnowledge?0:e.rangeOfKnowledge>n.rangeOfKnowledge?-1:1})):n.sort===Qe.STATUS_DESK?t.sort((function(e,n){return e.rangeOfKnowledge===n.rangeOfKnowledge?0:e.rangeOfKnowledge>n.rangeOfKnowledge?1:-1})):t}(e,r)})))})),this.resetCardProgressChannel=new L((function(e){var t=e.cardID,a=e.cardsGroupID;return n.getBackup().pipe(Object(ue.a)((function(e){return function(e,n,t){var a=t.findIndex((function(n){return e===n.id})),i=-1;return a>=0&&(i=t[a].cards.findIndex((function(e){return n===e.id}))),a>=0&&i>=0&&(t[a].cards[i].rangeOfKnowledge=r.TO_DO),t}(a,t,e)})),Object(Nn.a)((function(e){n.setBackup(e)})))})),this.deleteCardChannel=new L((function(e){var t=e.cardID,r=e.cardsGroupID;return n.getBackup().pipe(Object(ue.a)((function(e){return function(e,n,t){var r=t.findIndex((function(n){return e===n.id})),a=-1;return r>=0&&(a=t[r].cards.findIndex((function(e){return n===e.id}))),r>=0&&a>=0&&(t[r].cards=t[r].cards.filter((function(e){return e.id!==n}))),t}(r,t,e)})),Object(Nn.a)((function(e){n.setBackup(e)})))}))}(nt),st=new function e(n){var t=this;Object(h.a)(this,e),this.storageService=n,this.currentCardChannel=void 0,this.cardChannel=void 0,this.repeatingResultChannel=void 0,this.statisticChannel=void 0,this.statisticValue={inProgress:0,todo:0,done:0},this.cardChannel=new L((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return t.storageService.getBackup().pipe(Object(ue.a)((function(n){return qn(n,e)})),Object(An.a)((function(e){return t.storageService.getSettings().pipe(Object(ue.a)((function(n){return n.isRandomRepeating&&(e=Vn(e)),{cards:e,isRundomRepeating:n.isRandomRepeating}})))})),Object(Nn.a)((function(e){var n=e.cards;e.isRundomRepeating;t.statisticValue=Hn(n)})),Object(ue.a)((function(e){var n=e.cards,t=e.isRundomRepeating;return Mn(n,t)})))})),this.repeatingResultChannel=new L((function(e){return t.storageService.getBackup().pipe(Object(ue.a)((function(n){return zn(e,n)})),Object(An.a)((function(e){return t.storageService.setBackup(e)})))})),this.currentCardChannel=new L((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t.storageService.getBackup().pipe(Object(ue.a)((function(n){return qn(n,e)})),Object(ue.a)((function(e){return Jn(e)})))})),this.statisticChannel=new L((function(){return Object(R.a)(t.statisticValue)}))}(nt),ut=new function e(n){var t=this;Object(h.a)(this,e),this.storageService=n,this.localBackupChannel=void 0,this.loadBackupChannel=void 0,this.localBackupChannel=new L((function(){return t.storageService.getBackup().pipe(Object(Nn.a)((function(e){return function(e){var n=JSON.stringify(e,null,4),t=new Blob([n],{type:"octet/stream"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a&&(a.href=r,a.download="My Cards.txt",a.click()),window.URL.revokeObjectURL(r)}(e)})))})),this.loadBackupChannel=new L((function(e){return Object(R.a)("").pipe(Object(An.a)((function(){return t.storageService.setBackup(JSON.parse(e))})))}))}(nt),lt=new function e(n){Object(h.a)(this,e),this.settingsChannel=void 0,this.changeSettingsChannel=void 0,this.settingsChannel=new L((function(){return n.getSettings()})),this.changeSettingsChannel=new L((function(e){return n.setSettings(e)}))}(nt),dt=new function e(n){var t=this;Object(h.a)(this,e),this.storageService=n,this.cardChannel=void 0,this.repeatingResultChannel=void 0,this.cardChannel=new L((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return t.storageService.getBackup().pipe(Object(ue.a)((function(n){return Yn(n,e)})))})),this.repeatingResultChannel=new L((function(e){return t.storageService.getBackup().pipe(Object(ue.a)((function(n){return zn(e,n)})),Object(An.a)((function(e){return t.storageService.setBackup(e)})))}))}(nt);var ht=function(){var e=Object(a.useState)(ie),n=Object(u.a)(e,2),t=n[0],r=n[1];return Object(a.useEffect)((function(){var e=window.screen.height,n=window.screen.width;t.height===e&&t.width===n||r(Object(s.a)(Object(s.a)({},t),{},{height:e,width:n}))}),[t]),Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(Xn.Provider,{value:t,children:Object(T.jsx)(l.a,{children:Object(T.jsxs)("div",{children:[Object(T.jsx)(ne,{errorService:Zn}),Object(T.jsx)(K,{}),Object(T.jsx)(V,{}),Object(T.jsx)(se,{confirmDialogService:et}),Object(T.jsxs)("div",{className:"page-container",style:{height:t.height-110,width:t.width},children:[Object(T.jsx)(ae,{spinnerService:$n}),Object(T.jsx)(Rn,{cardsGroupsListService:rt,cardsGroupsEditorService:tt,googleAuthService:at,googleBackupsService:it,errorService:Zn,spinnerService:$n,confirmDialogService:et,cardsEditorService:ct,cardsListService:ot,cardsRepeaterService:st,localBackupsService:ut,settingsService:lt,cardViewerService:dt})]})]})})})})},pt=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,289)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,i=n.getLCP,c=n.getTTFB;t(e),r(e),a(e),i(e),c(e)}))};o.a.render(Object(T.jsx)(ht,{}),document.getElementById("root")),pt()}},[[194,1,2]]]);
//# sourceMappingURL=main.2751f69a.chunk.js.map